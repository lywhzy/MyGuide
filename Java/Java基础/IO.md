##Socket通信

### 建立通信链路

- 客户端首先要创建一个Socket实例，在这个实例的构造函数返回之前，将要进行TCP的三次握手协议，握手协议完成后，socket实例才被创建成功

- 服务端需要创建一个ServerSocket实例，默认监听所有地址与端口，然后调用accept方法进入阻塞状态，当有客户端请求时，则会创建一个套接字数据结构
并放入ServerSocket的未完成连接数据结构列表，注意，此时连接并未建立，需要等到Socket返回正确的构造函数，也就是TCP的三次握手正确进行后，才会
将这个连接放入已完成连接数据结构列表，所有，这些数据结构列表中每一个实例都是一个客户端建立的TCP连接


### 数据传输

- 大概思路是当连接建立成功后，服务端和客户端都会有一个Socket对象，每一个对象又有一对InputStream和OutputStream对象，操作系统会为每一个
对象分配足够的缓存区内存。数据发送方通过OutputStream将数据发送到其对应的队列中，数据接收方通过InputStream接收数据到对应的队列中

## NIO

- Channel对象作为NIO的通信信道，将信道绑定到IO对象上

- Selector对象作为NIO的选择器，可以同时监听一组通信信道，如果没有一个信道的状态发生变化，则会返回0，如果多个信道有数据，则会通过Selector
将数据分配到每个信道指定的Buffer中，在这里关键的地方就是，有一个线程来处理所有连接的数据交互，每个连接的数据交互方式都不是阻塞方式，所以可以
处理大量的连接请求

- Buffer对象作为NIO的数据缓冲区，可以用来存放信道传来的数据。注意，在创建Buffer对象后，需要申请内存，这里申请的内存并不是JAVA堆上的内存,
而是直接内存。这样就避免的内存在操作系统和JVM上互相复制造成的消耗